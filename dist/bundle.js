(()=>{"use strict";function e(e,t,n){const r=n.value;return{configurable:!0,get(){return r.bind(this)}}}var t;!function(e){e[e.Active=0]="Active",e[e.Finished=1]="Finished"}(t||(t={}));class n{constructor(e,t,n,r,i){this.id=e,this.title=t,this.description=n,this.people=r,this.projectStatus=i}}class r{constructor(){this.listeners=[]}addListener(e){this.listeners.push(e)}}class i extends r{constructor(){super(),this.project=[]}static getInstance(){return this.instance||(this.instance=new i),this.instance}addProject(e,r,i){const s=Math.random.toString(),o=new n(s,e,r,i,t.Active);this.project.push(o),this.updateListener()}moveProject(e,t){const n=this.project.find((t=>t.id===e));n&&n.projectStatus!=t&&(n.projectStatus=t,this.updateListener())}updateListener(){for(const e of this.listeners)e(this.project.slice())}}const s=i.getInstance();function o(e){let t=!0;return e.required&&(t=t&&0!==e.value.toString().trim().length),null!=e.minLength&&"string"==typeof e.value&&(t=t&&e.value.length>e.minLength),null!=e.maxLength&&"string"==typeof e.value&&(t=t&&e.value.length<e.maxLength),null!=e.min&&"number"==typeof e.value&&(t=t&&e.value>e.min),null!=e.max&&"number"==typeof e.value&&(t=t&&e.value<e.max),t}class l{constructor(e,t,n,r){this.templateElement=document.getElementById(e),this.hostElement=document.getElementById(t);const i=document.importNode(this.templateElement.content,!0);this.element=i.firstElementChild,r&&(this.element.id=r),this.attach(n)}attach(e){this.hostElement.insertAdjacentElement(e?"afterbegin":"beforeend",this.element)}}class a extends l{constructor(){super("project-input","app",!0,"user-input"),this.titleInputField=this.element.querySelector("#title"),this.descriptionInputField=this.element.querySelector("#description"),this.peopleInputField=this.element.querySelector("#people"),this.configure(),this.renderContent()}getUserInput(){const e=this.titleInputField.value,t=this.descriptionInputField.value,n=this.peopleInputField.value,r={value:t,required:!0,minLength:5},i={value:+n,required:!0,min:1,max:5};return o({value:e,required:!0})&&o(r)&&o(i)?[e,t,+n]:void alert("invalid input")}submitHandler(e){e.preventDefault();const t=this.getUserInput();if(Array.isArray(t)){const[e,n,r]=t;s.addProject(e,n,r),this.clearInput()}}clearInput(){this.titleInputField.value="",this.descriptionInputField.value="",this.peopleInputField.value=""}renderContent(){}configure(){this.element.addEventListener("submit",this.submitHandler)}}!function(e,t,n,r){var i,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(i=e[l])&&(o=(s<3?i(o):s>3?i(t,n,o):i(t,n))||o);s>3&&o&&Object.defineProperty(t,n,o)}([e],a.prototype,"submitHandler",null);class c extends l{constructor(e,t){super("single-project",e,!1,t.id),this.project=t,this.configure(),this.renderContent()}get persons(){return 1===this.project.people?"1 person":`${this.project.people} persons`}dragStartHandler(e){e.dataTransfer.setData("text/plain",this.project.id),e.dataTransfer.effectAllowed="move"}dragEndhandler(e){console.log(" ended ")}renderContent(){this.element.querySelector("h2").textContent=this.project.title,this.element.querySelector("h3").textContent=this.persons+" were assigned",this.element.querySelector("p").textContent=this.project.description}configure(){this.element.addEventListener("dragstart",this.dragStartHandler),this.element.addEventListener("dragend",this.dragEndhandler)}}!function(e,t,n,r){var i,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(i=e[l])&&(o=(s<3?i(o):s>3?i(t,n,o):i(t,n))||o);s>3&&o&&Object.defineProperty(t,n,o)}([e],c.prototype,"dragStartHandler",null);var d=function(e,t,n,r){var i,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(i=e[l])&&(o=(s<3?i(o):s>3?i(t,n,o):i(t,n))||o);return s>3&&o&&Object.defineProperty(t,n,o),o};class p extends l{constructor(e){super("project-list","app",!1,`${e}-projects`),this.type=e,this.assignedProject=[],this.assignedProject=[],this.configure(),this.renderContent()}dragOverhandeler(e){e.dataTransfer&&"text/plain"==e.dataTransfer.types[0]&&(e.preventDefault(),this.element.querySelector("ul").classList.add("droppable"))}dropHandler(e){var n;const r=null===(n=e.dataTransfer)||void 0===n?void 0:n.getData("text/plain");r&&s.moveProject(r,"active"===this.type?t.Active:t.Finished)}dragLeaveHandler(e){this.element.querySelector("ul").classList.remove("droppable")}renderProjects(){document.getElementById(`${this.type}-projects-list`).innerHTML="";for(const e of this.assignedProject)new c(this.element.querySelector("ul").id,e)}configure(){this.element.addEventListener("dragover",this.dragOverhandeler),this.element.addEventListener("dragleave",this.dragLeaveHandler),this.element.addEventListener("drop",this.dropHandler),s.addListener((e=>{const n=e.filter((e=>"active"==this.type?e.projectStatus==t.Active:e.projectStatus==t.Finished));this.assignedProject=n,this.renderProjects()}))}renderContent(){const e=`${this.type}-projects-list`;this.element.querySelector("ul").id=e,this.element.querySelector("h2").textContent=this.type.toUpperCase()+" PROJECTS"}}d([e],p.prototype,"dragOverhandeler",null),d([e],p.prototype,"dropHandler",null),d([e],p.prototype,"dragLeaveHandler",null),new a,new p("active"),new p("finished")})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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dXJjZXMiOlsid2VicGFjazovL3JlYWN0LXVkZW15Ly4vc3JjL2RlY29yYXRvci9hdXRvYmluZC50cyIsIndlYnBhY2s6Ly9yZWFjdC11ZGVteS8uL3NyYy9tb2RlbHMvcHJvamVjdC50cyIsIndlYnBhY2s6Ly9yZWFjdC11ZGVteS8uL3NyYy9zdGF0ZS9wcm9qZWN0LXN0YXRlLnRzIiwid2VicGFjazovL3JlYWN0LXVkZW15Ly4vc3JjL3V0aWxzL3ZhbGlkYXRpb24udHMiLCJ3ZWJwYWNrOi8vcmVhY3QtdWRlbXkvLi9zcmMvY29tcG9uZW50cy9iYXNlLWNvbXBvbmVudC50cyIsIndlYnBhY2s6Ly9yZWFjdC11ZGVteS8uL3NyYy9jb21wb25lbnRzL3Byb2plY3QtaW5wdXQudHMiLCJ3ZWJwYWNrOi8vcmVhY3QtdWRlbXkvLi9zcmMvY29tcG9uZW50cy9wcm9qZWN0LWl0ZW0udHMiLCJ3ZWJwYWNrOi8vcmVhY3QtdWRlbXkvLi9zcmMvY29tcG9uZW50cy9wcm9qZWN0LWxpc3QudHMiLCJ3ZWJwYWNrOi8vcmVhY3QtdWRlbXkvLi9zcmMvYXBwLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIlxuLy8gZGVjb3JhdG9yXG5leHBvcnQgZnVuY3Rpb24gYXV0b2JpbmQodGFyZ2V0OiBhbnksIG1ldGhvZE5hbWU6IHN0cmluZywgZGVzY3JpcHRvcjogUHJvcGVydHlEZXNjcmlwdG9yKSB7XG4gICAgY29uc3Qgb3JpZ2luYWxNZXRob2QgPSBkZXNjcmlwdG9yLnZhbHVlXG4gICAgY29uc3QgYWRqRGVzY3JpcHRvcjogUHJvcGVydHlEZXNjcmlwdG9yID0ge1xuICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgIGdldCgpIHtcbiAgICAgICAgICAgIGNvbnN0IGJvdW5kRm4gPSBvcmlnaW5hbE1ldGhvZC5iaW5kKHRoaXMpXG4gICAgICAgICAgICByZXR1cm4gYm91bmRGblxuICAgICAgICB9LFxuICAgIH1cbiAgICByZXR1cm4gYWRqRGVzY3JpcHRvclxufVxuIiwiXG5leHBvcnQgZW51bSBQcm9qZWN0U3RhdHVzIHsgQWN0aXZlLCBGaW5pc2hlZCB9XG5cbmV4cG9ydCBjbGFzcyBQcm9qZWN0IHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHVibGljIGlkOiBzdHJpbmcsXG4gICAgICAgIHB1YmxpYyB0aXRsZTogc3RyaW5nLFxuICAgICAgICBwdWJsaWMgZGVzY3JpcHRpb246IHN0cmluZyxcbiAgICAgICAgcHVibGljIHBlb3BsZTogbnVtYmVyLFxuICAgICAgICBwdWJsaWMgcHJvamVjdFN0YXR1czogUHJvamVjdFN0YXR1c1xuICAgICkgeyB9XG59XG4iLCJpbXBvcnQgeyBQcm9qZWN0LCBQcm9qZWN0U3RhdHVzIH0gZnJvbSBcIi4uL21vZGVscy9wcm9qZWN0XCJcblxuXG50eXBlIExpc3RlbmVyPFQ+ID0gKGl0ZW1zOiBUW10pID0+IHZvaWRcblxuY2xhc3MgU3RhdGU8VD57XG4gICAgcHJvdGVjdGVkIGxpc3RlbmVyczogTGlzdGVuZXI8VD5bXSA9IFtdXG5cbiAgICBhZGRMaXN0ZW5lcihsaXN0ZW5lckZ1bjogTGlzdGVuZXI8VD4pIHtcbiAgICAgICAgdGhpcy5saXN0ZW5lcnMucHVzaChsaXN0ZW5lckZ1bilcbiAgICB9XG59XG5cbmV4cG9ydCBjbGFzcyBQcm9qZWN0U3RhdGUgZXh0ZW5kcyBTdGF0ZTxQcm9qZWN0PiB7XG4gICAgcHJpdmF0ZSBwcm9qZWN0OiBQcm9qZWN0W10gPSBbXVxuICAgIHByaXZhdGUgc3RhdGljIGluc3RhbmNlOiBQcm9qZWN0U3RhdGVcblxuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlcigpXG4gICAgfVxuXG4gICAgc3RhdGljIGdldEluc3RhbmNlKCkge1xuICAgICAgICBpZiAodGhpcy5pbnN0YW5jZSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuaW5zdGFuY2VcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuaW5zdGFuY2UgPSBuZXcgUHJvamVjdFN0YXRlKClcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmluc3RhbmNlXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBhZGRQcm9qZWN0KHRpdGxlOiBzdHJpbmcsIGRlc2NyaXB0aW9uOiBzdHJpbmcsIG51bU9mUGVvcGxlOiBudW1iZXIpIHtcbiAgICAgICAgY29uc3QgaWQgPSBNYXRoLnJhbmRvbS50b1N0cmluZygpXG4gICAgICAgIGNvbnN0IHByb2plY3QgPSBuZXcgUHJvamVjdChpZCxcbiAgICAgICAgICAgIHRpdGxlLCBkZXNjcmlwdGlvbiwgbnVtT2ZQZW9wbGUsIFByb2plY3RTdGF0dXMuQWN0aXZlKVxuXG4gICAgICAgIHRoaXMucHJvamVjdC5wdXNoKHByb2plY3QpXG4gICAgICAgIHRoaXMudXBkYXRlTGlzdGVuZXIoKVxuXG4gICAgfVxuXG4gICAgbW92ZVByb2plY3QoaWQ6IHN0cmluZywgbmV3U3RhdHVzOiBQcm9qZWN0U3RhdHVzKSB7XG4gICAgICAgIGNvbnN0IHBybyA9IHRoaXMucHJvamVjdC5maW5kKGl0ZW0gPT4gaXRlbS5pZCA9PT0gaWQpXG4gICAgICAgIGlmIChwcm8gJiYgcHJvLnByb2plY3RTdGF0dXMgIT0gbmV3U3RhdHVzKSB7XG4gICAgICAgICAgICBwcm8ucHJvamVjdFN0YXR1cyA9IG5ld1N0YXR1c1xuICAgICAgICAgICAgdGhpcy51cGRhdGVMaXN0ZW5lcigpXG4gICAgICAgIH1cblxuICAgIH1cblxuICAgIHVwZGF0ZUxpc3RlbmVyKCkge1xuICAgICAgICBmb3IgKGNvbnN0IGxpc3RlbmVyIG9mIHRoaXMubGlzdGVuZXJzKSB7XG4gICAgICAgICAgICBsaXN0ZW5lcih0aGlzLnByb2plY3Quc2xpY2UoKSlcbiAgICAgICAgfVxuICAgIH1cblxuXG59XG5cbmV4cG9ydCBjb25zdCBwcm9qZWN0U3RhdGUgPSBQcm9qZWN0U3RhdGUuZ2V0SW5zdGFuY2UoKVxuIiwiZXhwb3J0IGludGVyZmFjZSBWYWxpZGF0YWJsZSB7XG4gICAgdmFsdWU6IHN0cmluZyB8IG51bWJlclxuICAgIHJlcXVpcmVkPzogYm9vbGVhblxuICAgIG1pbkxlbmd0aD86IG51bWJlclxuICAgIG1heExlbmd0aD86IG51bWJlclxuICAgIG1pbj86IG51bWJlclxuICAgIG1heD86IG51bWJlclxufVxuXG5leHBvcnQgZnVuY3Rpb24gdmFsaWRhdGUodmFsaWRhdGFibGVJbnB1dDogVmFsaWRhdGFibGUpIHtcbiAgICBsZXQgdmFsaWQgPSB0cnVlXG4gICAgaWYgKHZhbGlkYXRhYmxlSW5wdXQucmVxdWlyZWQpIHtcbiAgICAgICAgdmFsaWQgPSB2YWxpZCAmJiB2YWxpZGF0YWJsZUlucHV0LnZhbHVlLnRvU3RyaW5nKCkudHJpbSgpLmxlbmd0aCAhPT0gMFxuICAgIH1cblxuICAgIGlmICh2YWxpZGF0YWJsZUlucHV0Lm1pbkxlbmd0aCAhPSBudWxsICYmXG4gICAgICAgIHR5cGVvZiB2YWxpZGF0YWJsZUlucHV0LnZhbHVlID09PSAnc3RyaW5nJykge1xuICAgICAgICB2YWxpZCA9IHZhbGlkICYmIHZhbGlkYXRhYmxlSW5wdXQudmFsdWUubGVuZ3RoID4gdmFsaWRhdGFibGVJbnB1dC5taW5MZW5ndGhcbiAgICB9XG5cbiAgICBpZiAodmFsaWRhdGFibGVJbnB1dC5tYXhMZW5ndGggIT0gbnVsbCAmJlxuICAgICAgICB0eXBlb2YgdmFsaWRhdGFibGVJbnB1dC52YWx1ZSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgdmFsaWQgPSB2YWxpZCAmJiB2YWxpZGF0YWJsZUlucHV0LnZhbHVlLmxlbmd0aCA8IHZhbGlkYXRhYmxlSW5wdXQubWF4TGVuZ3RoXG4gICAgfVxuXG4gICAgaWYgKHZhbGlkYXRhYmxlSW5wdXQubWluICE9IG51bGwgJiYgdHlwZW9mIHZhbGlkYXRhYmxlSW5wdXQudmFsdWUgPT09ICdudW1iZXInKSB7XG4gICAgICAgIHZhbGlkID0gdmFsaWQgJiYgdmFsaWRhdGFibGVJbnB1dC52YWx1ZSA+IHZhbGlkYXRhYmxlSW5wdXQubWluXG4gICAgfVxuXG4gICAgaWYgKHZhbGlkYXRhYmxlSW5wdXQubWF4ICE9IG51bGwgJiYgdHlwZW9mIHZhbGlkYXRhYmxlSW5wdXQudmFsdWUgPT09ICdudW1iZXInKSB7XG4gICAgICAgIHZhbGlkID0gdmFsaWQgJiYgdmFsaWRhdGFibGVJbnB1dC52YWx1ZSA8IHZhbGlkYXRhYmxlSW5wdXQubWF4XG4gICAgfVxuXG4gICAgcmV0dXJuIHZhbGlkXG59XG4iLCJcbmV4cG9ydCBhYnN0cmFjdCBjbGFzcyBDb21wb25lbnQ8VCBleHRlbmRzIEhUTUxFbGVtZW50LCBVIGV4dGVuZHMgSFRNTEVsZW1lbnQ+e1xuICAgIHRlbXBsYXRlRWxlbWVudDogSFRNTFRlbXBsYXRlRWxlbWVudFxuICAgIGhvc3RFbGVtZW50OiBUXG4gICAgZWxlbWVudDogVVxuICAgIGNvbnN0cnVjdG9yKHRlbXBsYXRlSWQ6IHN0cmluZyxcbiAgICAgICAgaG9zdElkOiBzdHJpbmcsXG4gICAgICAgIGluc2VydEF0QmVnaW46IGJvb2xlYW4sXG4gICAgICAgIG5ld0VsZW1lbnRJZD86IHN0cmluZykge1xuICAgICAgICB0aGlzLnRlbXBsYXRlRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRlbXBsYXRlSWQpISBhcyBIVE1MVGVtcGxhdGVFbGVtZW50XG4gICAgICAgIHRoaXMuaG9zdEVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChob3N0SWQpISBhcyBUXG5cbiAgICAgICAgY29uc3QgaW1wb3J0Tm9kZSA9IGRvY3VtZW50LmltcG9ydE5vZGUodGhpcy50ZW1wbGF0ZUVsZW1lbnQuY29udGVudCwgdHJ1ZSlcbiAgICAgICAgdGhpcy5lbGVtZW50ID0gaW1wb3J0Tm9kZS5maXJzdEVsZW1lbnRDaGlsZCBhcyBVXG4gICAgICAgIGlmIChuZXdFbGVtZW50SWQpIHtcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5pZCA9IG5ld0VsZW1lbnRJZFxuICAgICAgICB9XG4gICAgICAgIHRoaXMuYXR0YWNoKGluc2VydEF0QmVnaW4pXG4gICAgfVxuXG4gICAgcHJpdmF0ZSBhdHRhY2goaW5zZXJ0QXRiZWdpbmluZzogYm9vbGVhbikge1xuICAgICAgICB0aGlzLmhvc3RFbGVtZW50Lmluc2VydEFkamFjZW50RWxlbWVudChpbnNlcnRBdGJlZ2luaW5nID8gJ2FmdGVyYmVnaW4nIDogJ2JlZm9yZWVuZCcsIHRoaXMuZWxlbWVudClcbiAgICB9XG5cbiAgICBhYnN0cmFjdCBjb25maWd1cmUoKTogdm9pZFxuICAgIGFic3RyYWN0IHJlbmRlckNvbnRlbnQoKTogdm9pZFxuXG59XG4iLCJpbXBvcnQgeyBhdXRvYmluZCB9IGZyb20gXCIuLi9kZWNvcmF0b3IvYXV0b2JpbmRcIlxuaW1wb3J0IHsgcHJvamVjdFN0YXRlIH0gZnJvbSBcIi4uL3N0YXRlL3Byb2plY3Qtc3RhdGVcIlxuaW1wb3J0IHsgdmFsaWRhdGUsIFZhbGlkYXRhYmxlIH0gZnJvbSBcIi4uL3V0aWxzL3ZhbGlkYXRpb25cIlxuaW1wb3J0IHsgQ29tcG9uZW50IH0gZnJvbSBcIi4vYmFzZS1jb21wb25lbnRcIlxuXG5cbi8vIFByb2plY3RJbnB1dCBjbGFzc1xuZXhwb3J0IGNsYXNzIFByb2plY3RJbnB1dCBleHRlbmRzIENvbXBvbmVudDxIVE1MRGl2RWxlbWVudCwgSFRNTEZvcm1FbGVtZW50PntcblxuICAgIHRpdGxlSW5wdXRGaWVsZDogSFRNTElucHV0RWxlbWVudFxuICAgIGRlc2NyaXB0aW9uSW5wdXRGaWVsZDogSFRNTElucHV0RWxlbWVudFxuICAgIHBlb3BsZUlucHV0RmllbGQ6IEhUTUxJbnB1dEVsZW1lbnRcblxuXG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHN1cGVyKFwicHJvamVjdC1pbnB1dFwiLCAnYXBwJywgdHJ1ZSwgXCJ1c2VyLWlucHV0XCIpXG5cbiAgICAgICAgdGhpcy50aXRsZUlucHV0RmllbGQgPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcihcIiN0aXRsZVwiKSBhcyBIVE1MSW5wdXRFbGVtZW50XG4gICAgICAgIHRoaXMuZGVzY3JpcHRpb25JbnB1dEZpZWxkID0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZGVzY3JpcHRpb25cIikgYXMgSFRNTElucHV0RWxlbWVudFxuICAgICAgICB0aGlzLnBlb3BsZUlucHV0RmllbGQgPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcihcIiNwZW9wbGVcIikgYXMgSFRNTElucHV0RWxlbWVudFxuICAgICAgICB0aGlzLmNvbmZpZ3VyZSgpXG4gICAgICAgIHRoaXMucmVuZGVyQ29udGVudCgpXG5cbiAgICB9XG5cbiAgICBwcml2YXRlIGdldFVzZXJJbnB1dCgpOiBbc3RyaW5nLCBzdHJpbmcsIG51bWJlcl0gfCB2b2lkIHtcbiAgICAgICAgY29uc3QgZW50ZXJlZFRpdGxlID0gdGhpcy50aXRsZUlucHV0RmllbGQudmFsdWVcbiAgICAgICAgY29uc3QgZW50ZXJlZERlc2NyaXB0aW9uID0gdGhpcy5kZXNjcmlwdGlvbklucHV0RmllbGQudmFsdWVcbiAgICAgICAgY29uc3QgZW50ZXJlZFBlb3BsZSA9IHRoaXMucGVvcGxlSW5wdXRGaWVsZC52YWx1ZVxuXG4gICAgICAgIGNvbnN0IHRpdGxlVmFsaWRhdGVBYmxlOiBWYWxpZGF0YWJsZSA9IHtcbiAgICAgICAgICAgIHZhbHVlOiBlbnRlcmVkVGl0bGUsXG4gICAgICAgICAgICByZXF1aXJlZDogdHJ1ZVxuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgZGVzY3JpcHRpb25WYWxpZGF0ZUFibGU6IFZhbGlkYXRhYmxlID0ge1xuICAgICAgICAgICAgdmFsdWU6IGVudGVyZWREZXNjcmlwdGlvbixcbiAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgICAgbWluTGVuZ3RoOiA1XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgcGVvcGxlVmFsaWRhdGVBYmxlOiBWYWxpZGF0YWJsZSA9IHtcbiAgICAgICAgICAgIHZhbHVlOiArZW50ZXJlZFBlb3BsZSxcbiAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgICAgbWluOiAxLFxuICAgICAgICAgICAgbWF4OiA1XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIXZhbGlkYXRlKHRpdGxlVmFsaWRhdGVBYmxlKSB8fFxuICAgICAgICAgICAgIXZhbGlkYXRlKGRlc2NyaXB0aW9uVmFsaWRhdGVBYmxlKSB8fFxuICAgICAgICAgICAgIXZhbGlkYXRlKHBlb3BsZVZhbGlkYXRlQWJsZSlcbiAgICAgICAgKSB7XG4gICAgICAgICAgICBhbGVydChcImludmFsaWQgaW5wdXRcIilcbiAgICAgICAgICAgIHJldHVyblxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIFtlbnRlcmVkVGl0bGUsIGVudGVyZWREZXNjcmlwdGlvbiwgK2VudGVyZWRQZW9wbGVdXG4gICAgICAgIH1cblxuICAgIH1cblxuICAgIEBhdXRvYmluZFxuICAgIHByaXZhdGUgc3VibWl0SGFuZGxlcihldmVudDogRXZlbnQpIHtcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKVxuICAgICAgICBjb25zdCB1c2VySW5wdXQgPSB0aGlzLmdldFVzZXJJbnB1dCgpXG4gICAgICAgIGlmIChBcnJheS5pc0FycmF5KHVzZXJJbnB1dCkpIHtcbiAgICAgICAgICAgIGNvbnN0IFt0aXRsZSwgZGVzY3JpcHRpb24sIHBlb3BsZV0gPSB1c2VySW5wdXRcbiAgICAgICAgICAgIHByb2plY3RTdGF0ZS5hZGRQcm9qZWN0KHRpdGxlLCBkZXNjcmlwdGlvbiwgcGVvcGxlKVxuICAgICAgICAgICAgdGhpcy5jbGVhcklucHV0KClcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgY2xlYXJJbnB1dCgpIHtcbiAgICAgICAgdGhpcy50aXRsZUlucHV0RmllbGQudmFsdWUgPSAnJ1xuICAgICAgICB0aGlzLmRlc2NyaXB0aW9uSW5wdXRGaWVsZC52YWx1ZSA9ICcnXG4gICAgICAgIHRoaXMucGVvcGxlSW5wdXRGaWVsZC52YWx1ZSA9ICcnXG4gICAgfVxuXG4gICAgcmVuZGVyQ29udGVudCgpOiB2b2lkIHtcblxuICAgIH1cblxuICAgIGNvbmZpZ3VyZSgpIHtcbiAgICAgICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIHRoaXMuc3VibWl0SGFuZGxlcilcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBhdXRvYmluZCB9IGZyb20gXCIuLi9kZWNvcmF0b3IvYXV0b2JpbmRcIlxuaW1wb3J0IHsgUHJvamVjdCB9IGZyb20gXCIuLi9tb2RlbHMvcHJvamVjdFwiXG5pbXBvcnQgeyBDb21wb25lbnQgfSBmcm9tIFwiLi9iYXNlLWNvbXBvbmVudFwiXG5pbXBvcnQgeyBEcmFnZ2FibGUgfSBmcm9tIFwiLi4vbW9kZWxzL2RyYWctZHJvcC1pbnRlcmZhY2VcIlxuXG5cblxuZXhwb3J0IGNsYXNzIFByb2plY3RJdGVtIGV4dGVuZHMgQ29tcG9uZW50PEhUTUxVTGlzdEVsZW1lbnQsIEhUTUxMSUVsZW1lbnQ+IGltcGxlbWVudHMgRHJhZ2dhYmxlIHtcbiAgICBwcml2YXRlIHByb2plY3Q6IFByb2plY3RcblxuICAgIGdldCBwZXJzb25zKCkge1xuICAgICAgICBpZiAodGhpcy5wcm9qZWN0LnBlb3BsZSA9PT0gMSkge1xuICAgICAgICAgICAgcmV0dXJuIFwiMSBwZXJzb25cIlxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIGAke3RoaXMucHJvamVjdC5wZW9wbGV9IHBlcnNvbnNgXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zdHJ1Y3Rvcihob3N0SWQ6IHN0cmluZywgcHJvamVjdDogUHJvamVjdCkge1xuICAgICAgICBzdXBlcignc2luZ2xlLXByb2plY3QnLCBob3N0SWQsIGZhbHNlLCBwcm9qZWN0LmlkKVxuICAgICAgICB0aGlzLnByb2plY3QgPSBwcm9qZWN0XG4gICAgICAgIHRoaXMuY29uZmlndXJlKClcbiAgICAgICAgdGhpcy5yZW5kZXJDb250ZW50KClcblxuICAgIH1cblxuICAgIEBhdXRvYmluZFxuICAgIGRyYWdTdGFydEhhbmRsZXIoZXZlbnQ6IERyYWdFdmVudCk6IHZvaWQge1xuXG4gICAgICAgIGV2ZW50LmRhdGFUcmFuc2ZlciEuc2V0RGF0YShcInRleHQvcGxhaW5cIiwgdGhpcy5wcm9qZWN0LmlkKVxuICAgICAgICBldmVudC5kYXRhVHJhbnNmZXIhLmVmZmVjdEFsbG93ZWQgPSAnbW92ZSdcblxuICAgIH1cblxuICAgIGRyYWdFbmRoYW5kbGVyKF86IERyYWdFdmVudCk6IHZvaWQge1xuICAgICAgICBjb25zb2xlLmxvZyhcIiBlbmRlZCBcIik7XG4gICAgfVxuXG4gICAgcmVuZGVyQ29udGVudCgpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ2gyJykhLnRleHRDb250ZW50ID0gdGhpcy5wcm9qZWN0LnRpdGxlXG4gICAgICAgIHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCdoMycpIS50ZXh0Q29udGVudCA9IHRoaXMucGVyc29ucyArIFwiIHdlcmUgYXNzaWduZWRcIlxuICAgICAgICB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcigncCcpIS50ZXh0Q29udGVudCA9IHRoaXMucHJvamVjdC5kZXNjcmlwdGlvblxuICAgIH1cblxuICAgIGNvbmZpZ3VyZSgpOiB2b2lkIHtcbiAgICAgICAgLy8gd2l0aG91dCBhdXRvYmluZFxuICAgICAgICAvLyB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ3N0YXJ0JywgdGhpcy5kcmFnU3RhcnRIYW5kbGVyLmJpbmQodGhpcykpXG4gICAgICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdkcmFnc3RhcnQnLCB0aGlzLmRyYWdTdGFydEhhbmRsZXIpXG4gICAgICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdkcmFnZW5kJywgdGhpcy5kcmFnRW5kaGFuZGxlcilcblxuICAgIH1cblxufVxuIiwiaW1wb3J0IHsgYXV0b2JpbmQgfSBmcm9tIFwiLi4vZGVjb3JhdG9yL2F1dG9iaW5kXCJcbmltcG9ydCB7IFByb2plY3QsIFByb2plY3RTdGF0dXMgfSBmcm9tIFwiLi4vbW9kZWxzL3Byb2plY3RcIlxuaW1wb3J0IHsgQ29tcG9uZW50IH0gZnJvbSBcIi4vYmFzZS1jb21wb25lbnRcIlxuaW1wb3J0IHsgRHJhZ1RhcmdldCB9IGZyb20gXCIuLi9tb2RlbHMvZHJhZy1kcm9wLWludGVyZmFjZVwiXG5pbXBvcnQgeyBQcm9qZWN0SXRlbSB9IGZyb20gXCIuL3Byb2plY3QtaXRlbVwiXG5pbXBvcnQgeyBwcm9qZWN0U3RhdGUgfSBmcm9tIFwiLi4vc3RhdGUvcHJvamVjdC1zdGF0ZVwiXG5cblxuXG5leHBvcnQgY2xhc3MgUHJvamVjdExpc3QgZXh0ZW5kcyBDb21wb25lbnQ8SFRNTERpdkVsZW1lbnQsIEhUTUxFbGVtZW50PiBpbXBsZW1lbnRzIERyYWdUYXJnZXQge1xuXG4gICAgYXNzaWduZWRQcm9qZWN0OiBQcm9qZWN0W10gPSBbXVxuXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSB0eXBlOiBcImFjdGl2ZVwiIHwgJ2ZpbmlzaGVkJykge1xuICAgICAgICBzdXBlcigncHJvamVjdC1saXN0JywgJ2FwcCcsIGZhbHNlLCBgJHt0eXBlfS1wcm9qZWN0c2ApXG4gICAgICAgIHRoaXMuYXNzaWduZWRQcm9qZWN0ID0gW11cbiAgICAgICAgdGhpcy5jb25maWd1cmUoKVxuICAgICAgICB0aGlzLnJlbmRlckNvbnRlbnQoKVxuICAgIH1cbiAgICBAYXV0b2JpbmRcbiAgICBkcmFnT3ZlcmhhbmRlbGVyKGV2ZW50OiBEcmFnRXZlbnQpOiB2b2lkIHtcblxuICAgICAgICBpZiAoZXZlbnQuZGF0YVRyYW5zZmVyICYmIGV2ZW50LmRhdGFUcmFuc2Zlci50eXBlc1swXSA9PSAndGV4dC9wbGFpbicpIHtcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KClcbiAgICAgICAgICAgIGNvbnN0IGl0ZW1MaSA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwidWxcIikhXG4gICAgICAgICAgICBpdGVtTGkuY2xhc3NMaXN0LmFkZCgnZHJvcHBhYmxlJylcbiAgICAgICAgfVxuXG4gICAgfVxuXG4gICAgQGF1dG9iaW5kXG4gICAgZHJvcEhhbmRsZXIoZXZlbnQ6IERyYWdFdmVudCk6IHZvaWQge1xuXG4gICAgICAgIGNvbnN0IGlkID0gZXZlbnQuZGF0YVRyYW5zZmVyPy5nZXREYXRhKCd0ZXh0L3BsYWluJylcbiAgICAgICAgaWYgKGlkKVxuICAgICAgICAgICAgcHJvamVjdFN0YXRlLm1vdmVQcm9qZWN0KGlkLCB0aGlzLnR5cGUgPT09ICdhY3RpdmUnID8gUHJvamVjdFN0YXR1cy5BY3RpdmUgOiBQcm9qZWN0U3RhdHVzLkZpbmlzaGVkKVxuXG4gICAgfVxuXG4gICAgQGF1dG9iaW5kXG4gICAgZHJhZ0xlYXZlSGFuZGxlcihfOiBEcmFnRXZlbnQpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgaXRlbUxpID0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCJ1bFwiKSFcbiAgICAgICAgaXRlbUxpLmNsYXNzTGlzdC5yZW1vdmUoJ2Ryb3BwYWJsZScpXG4gICAgfVxuXG4gICAgcHJpdmF0ZSByZW5kZXJQcm9qZWN0cygpIHtcbiAgICAgICAgY29uc3QgbGlzdEVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYCR7dGhpcy50eXBlfS1wcm9qZWN0cy1saXN0YCkhIGFzIEhUTUxVTGlzdEVsZW1lbnRcbiAgICAgICAgbGlzdEVsLmlubmVySFRNTCA9ICcnXG4gICAgICAgIGZvciAoY29uc3QgaXRlbSBvZiB0aGlzLmFzc2lnbmVkUHJvamVjdCkge1xuICAgICAgICAgICAgbmV3IFByb2plY3RJdGVtKHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCd1bCcpIS5pZCwgaXRlbSlcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGNvbmZpZ3VyZSgpOiB2b2lkIHtcblxuICAgICAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ292ZXInLCB0aGlzLmRyYWdPdmVyaGFuZGVsZXIpXG4gICAgICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdkcmFnbGVhdmUnLCB0aGlzLmRyYWdMZWF2ZUhhbmRsZXIpXG4gICAgICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdkcm9wJywgdGhpcy5kcm9wSGFuZGxlcilcblxuICAgICAgICBwcm9qZWN0U3RhdGUuYWRkTGlzdGVuZXIoKHByb2plY3RzOiBQcm9qZWN0W10pID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGZpbHRlclByb2plY3QgPSBwcm9qZWN0cy5maWx0ZXIoaXRlbSA9PiB7XG5cbiAgICAgICAgICAgICAgICBpZiAodGhpcy50eXBlID09IFwiYWN0aXZlXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGl0ZW0ucHJvamVjdFN0YXR1cyA9PSBQcm9qZWN0U3RhdHVzLkFjdGl2ZVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gaXRlbS5wcm9qZWN0U3RhdHVzID09IFByb2plY3RTdGF0dXMuRmluaXNoZWRcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB0aGlzLmFzc2lnbmVkUHJvamVjdCA9IGZpbHRlclByb2plY3RcbiAgICAgICAgICAgIHRoaXMucmVuZGVyUHJvamVjdHMoKVxuICAgICAgICB9KVxuICAgIH1cbiAgICByZW5kZXJDb250ZW50KCkge1xuICAgICAgICBjb25zdCBpdGVtSWQgPSBgJHt0aGlzLnR5cGV9LXByb2plY3RzLWxpc3RgXG4gICAgICAgIHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCd1bCcpIS5pZCA9IGl0ZW1JZFxuICAgICAgICB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcignaDInKSEudGV4dENvbnRlbnQgPSB0aGlzLnR5cGUudG9VcHBlckNhc2UoKSArIFwiIFBST0pFQ1RTXCJcbiAgICB9XG5cblxuXG59XG4iLCJpbXBvcnQgeyBQcm9qZWN0SW5wdXQgfSBmcm9tIFwiLi9jb21wb25lbnRzL3Byb2plY3QtaW5wdXRcIlxuaW1wb3J0IHsgUHJvamVjdExpc3QgfSBmcm9tIFwiLi9jb21wb25lbnRzL3Byb2plY3QtbGlzdFwiXG5cblxubmV3IFByb2plY3RJbnB1dCgpXG5cbm5ldyBQcm9qZWN0TGlzdCgnYWN0aXZlJylcbm5ldyBQcm9qZWN0TGlzdCgnZmluaXNoZWQnKVxuXG5cblxuXG5cbiJdLCJuYW1lcyI6WyJhdXRvYmluZCIsInRhcmdldCIsIm1ldGhvZE5hbWUiLCJkZXNjcmlwdG9yIiwib3JpZ2luYWxNZXRob2QiLCJ2YWx1ZSIsImNvbmZpZ3VyYWJsZSIsImdldCIsImJpbmQiLCJ0aGlzIiwiUHJvamVjdFN0YXR1cyIsIlByb2plY3QiLCJjb25zdHJ1Y3RvciIsImlkIiwidGl0bGUiLCJkZXNjcmlwdGlvbiIsInBlb3BsZSIsInByb2plY3RTdGF0dXMiLCJTdGF0ZSIsImxpc3RlbmVycyIsImFkZExpc3RlbmVyIiwibGlzdGVuZXJGdW4iLCJwdXNoIiwiUHJvamVjdFN0YXRlIiwic3VwZXIiLCJwcm9qZWN0Iiwic3RhdGljIiwiaW5zdGFuY2UiLCJhZGRQcm9qZWN0IiwibnVtT2ZQZW9wbGUiLCJNYXRoIiwicmFuZG9tIiwidG9TdHJpbmciLCJBY3RpdmUiLCJ1cGRhdGVMaXN0ZW5lciIsIm1vdmVQcm9qZWN0IiwibmV3U3RhdHVzIiwicHJvIiwiZmluZCIsIml0ZW0iLCJsaXN0ZW5lciIsInNsaWNlIiwicHJvamVjdFN0YXRlIiwiZ2V0SW5zdGFuY2UiLCJ2YWxpZGF0ZSIsInZhbGlkYXRhYmxlSW5wdXQiLCJ2YWxpZCIsInJlcXVpcmVkIiwidHJpbSIsImxlbmd0aCIsIm1pbkxlbmd0aCIsIm1heExlbmd0aCIsIm1pbiIsIm1heCIsIkNvbXBvbmVudCIsInRlbXBsYXRlSWQiLCJob3N0SWQiLCJpbnNlcnRBdEJlZ2luIiwibmV3RWxlbWVudElkIiwidGVtcGxhdGVFbGVtZW50IiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsImhvc3RFbGVtZW50IiwiaW1wb3J0Tm9kZSIsImNvbnRlbnQiLCJlbGVtZW50IiwiZmlyc3RFbGVtZW50Q2hpbGQiLCJhdHRhY2giLCJpbnNlcnRBdGJlZ2luaW5nIiwiaW5zZXJ0QWRqYWNlbnRFbGVtZW50IiwiUHJvamVjdElucHV0IiwidGl0bGVJbnB1dEZpZWxkIiwicXVlcnlTZWxlY3RvciIsImRlc2NyaXB0aW9uSW5wdXRGaWVsZCIsInBlb3BsZUlucHV0RmllbGQiLCJjb25maWd1cmUiLCJyZW5kZXJDb250ZW50IiwiZ2V0VXNlcklucHV0IiwiZW50ZXJlZFRpdGxlIiwiZW50ZXJlZERlc2NyaXB0aW9uIiwiZW50ZXJlZFBlb3BsZSIsImRlc2NyaXB0aW9uVmFsaWRhdGVBYmxlIiwicGVvcGxlVmFsaWRhdGVBYmxlIiwiYWxlcnQiLCJzdWJtaXRIYW5kbGVyIiwiZXZlbnQiLCJwcmV2ZW50RGVmYXVsdCIsInVzZXJJbnB1dCIsIkFycmF5IiwiaXNBcnJheSIsImNsZWFySW5wdXQiLCJhZGRFdmVudExpc3RlbmVyIiwiUHJvamVjdEl0ZW0iLCJwZXJzb25zIiwiZHJhZ1N0YXJ0SGFuZGxlciIsImRhdGFUcmFuc2ZlciIsInNldERhdGEiLCJlZmZlY3RBbGxvd2VkIiwiZHJhZ0VuZGhhbmRsZXIiLCJfIiwiY29uc29sZSIsImxvZyIsInRleHRDb250ZW50IiwiUHJvamVjdExpc3QiLCJ0eXBlIiwiYXNzaWduZWRQcm9qZWN0IiwiZHJhZ092ZXJoYW5kZWxlciIsInR5cGVzIiwiY2xhc3NMaXN0IiwiYWRkIiwiZHJvcEhhbmRsZXIiLCJnZXREYXRhIiwiRmluaXNoZWQiLCJkcmFnTGVhdmVIYW5kbGVyIiwicmVtb3ZlIiwicmVuZGVyUHJvamVjdHMiLCJpbm5lckhUTUwiLCJwcm9qZWN0cyIsImZpbHRlclByb2plY3QiLCJmaWx0ZXIiLCJpdGVtSWQiLCJ0b1VwcGVyQ2FzZSJdLCJzb3VyY2VSb290IjoiIn0=